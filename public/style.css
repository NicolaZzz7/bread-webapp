/* ==============================
   1. БАЗА (переменные и ресет)
================================*/
* { margin: 0; padding: 0; box-sizing: border-box; } /* сброс отступов */

:root { /* глобальные переменные для тем */
  --primary: #48bb78;            /* зелёный основной */
  --primary-dark: #38a169;       /* зелёный при hover */
  --error: #e53e3e;              /* красный ошибки */
  --error-dark: #c53030;         /* красный hover */
  --bg-color: #ffffff;           /* фон */
  --text-color: #2d3748;         /* цвет текста */
  --card-bg: #ffffff;            /* фон карточек/модалок */
  --border-color: #e2e8f0;       /* цвет бордеров */
  --shadow: 0 2px 12px rgba(0, 0, 0, 0.1); /* тень */
}

@media (prefers-color-scheme: dark) {
  :root { /* тёмная тема */
    --bg-color: #1a202c;
    --text-color: #e2e8f0;
    --card-bg: #2d3748;
    --border-color: #4a5568;
    --shadow: 0 2px 12px rgba(0,0,0,0.3);
  }
}

body { /* всё тело страницы */
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
  background: var(--bg-color);
  color: var(--text-color);
  line-height: 1.6;
}

.container { /* основной контейнер страницы */
  max-width: 100%;
  padding: 16px;
}

/* ==============================
   2. ОБЩИЕ ЭЛЕМЕНТЫ
================================*/
.header { /* шапка */
  text-align: center;
  margin-bottom: 24px;
  padding: 20px 0;
}
.header h1 { font-size: 28px; margin-bottom: 8px; } /* заголовок */
.header p { color: #718096; font-size: 16px; } /* подзаголовок */

.search-box { margin-bottom: 20px; } /* блок поиска */
.search-box input { /* поле поиска */
  width: 100%;
  padding: 14px 16px;
  border: 2px solid var(--border-color);
  border-radius: 12px;
  font-size: 16px;
  background: var(--card-bg);
  color: var(--text-color);
  transition: border-color 0.3s;
}
.search-box input:focus { border-color: var(--primary); } /* активное поле */

.empty-state { /* заглушка пустого каталога */ }
.loading { /* индикатор загрузки */ }

.empty-state .icon { font-size: 48px; margin-bottom: 16px; } /* иконка пустого */
.loading .spinner { font-size: 32px; margin-bottom: 16px; animation: bounce 1s infinite; }

@keyframes bounce { /* анимация спиннера */
  0%,100% { transform: translateY(0); }
  50% { transform: translateY(-5px); }
}

/* ==============================
   3. КАТАЛОГ
================================*/
.product-grid { /* сетка товаров */
  display: grid;
  gap: 16px;
}

.product-card { /* карточка товара */
  background: var(--card-bg);
  border-radius: 16px;
  padding: 20px;
  box-shadow: var(--shadow);
  border: 1px solid var(--border-color);
  position: relative;
  display: flex;
  flex-direction: column;
  cursor: pointer;
  transition: all 0.3s ease;
}
.product-card:hover { transform: translateY(-2px); }

.product-image { /* контейнер картинки */
  width: 100%;
  aspect-ratio: 800 / 464;
  margin-bottom: 12px;
  border-radius: 12px;
  overflow: hidden;
  background: var(--card-bg);
}
.product-image img { /* сама картинка */
  width: 100%; height: 100%;
  object-fit: cover;
  display: block;
}

.product-image-slider { position: relative; width: 100%; height: 100%; overflow: hidden; } /* слайдер в карточке */
.product-image-slider .slide { position: absolute; top: 0; left: 0; width: 100%; height: 100%; opacity: 0; transition: opacity 1s; } /* кадр */
.product-image-slider .slide.active { opacity: 1; } /* активный кадр */

.product-info { flex: 1; } /* инфо о продукте */
.product-name { font-size: 18px; font-weight: 600; margin-bottom: 4px; cursor: pointer; } /* название */
.product-ingredients { font-size: 14px; color: #718096; margin-bottom: 12px; line-height: 1.4; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; } /* состав */
.product-meta { display: flex; gap: 12px; font-size: 13px; color: #718096; } /* блок метаданных */
.meta-item { display: flex; align-items: center; gap: 4px; } /* элемент меты */

/* Индикатор количества товара на карточке */
.product-quantity-indicator { position: absolute; top: 8px; right: 8px; width: 40px; height: 40px; display: flex; align-items: center; justify-content: center; pointer-events: none; z-index: 10; }
.product-quantity-indicator .bread-base { position: absolute; width: 100%; height: 100%; object-fit: contain; z-index: 1; pointer-events: none; } /* иконка хлеба */
.product-quantity-indicator .steam-anim { position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 2; } /* пар */
.product-quantity-indicator .steam-frame { position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: contain; opacity: 0; transition: opacity 3s ease; } /* кадр пара */
.product-quantity-indicator .steam-frame.active { opacity: 1; } /* активный кадр */
.product-quantity-count { position: absolute; bottom: 12px; right: -8px; min-width: 18px; height: 18px; background: var(--primary); color: #fff; border-radius: 50%; font-size: 12px; font-weight: 600; display: flex; align-items: center; justify-content: center; z-index: 3; padding: 0 5px; }

/* Блок выбора веса */
.weight-row-container { display: flex; flex-direction: row; gap: 8px; width: 100%; } /* контейнер строк */
.weight-row { flex: 1 1 50%; max-width: calc(50% - 4px); display: flex; align-items: center; justify-content: space-between; padding: 6px 10px; height: 56px; border-radius: 10px; border: 1px solid var(--border-color); background: var(--bg-color); } /* одна строка */
.weight-info { display: flex; gap: 8px; } /* инфо о весе */
.weight-label, .weight-price { font-size: 14px; font-weight: 600; } /* надпись веса */
.weight-price { color: var(--primary); } /* цена зелёным */

/* +/- кнопки */
.quantity-controls { display: flex; align-items: center; } /* контейнер кнопок */
.quantity-btn { border: none; background: none; color: var(--primary); font-size: 18px; font-weight: 700; cursor: pointer; padding: 0 6px; } /* кнопка */
.quantity-value { font-size: 14px; font-weight: 600; min-width: 16px; text-align: center; } /* значение */

/* Плавное переключение кнопки "В корзину" ↔ контролы */
.transition-container { position: relative; width: 100%; min-height: 56px; margin-top: 12px; }
.transition-container > * { position: absolute; top: 0; left: 0; width: 100%; height: 56px; transition: opacity .3s, transform .3s; }
.transition-container > *.visible { opacity: 1; transform: translateY(0); pointer-events: auto; }
.transition-container > *.hidden { opacity: 0; pointer-events: none; }

/* Кнопки */
.add-to-cart-btn { width: 100%; height: 56px; background: var(--primary); color: #fff; border: none; border-radius: 12px; font-size: 16px; font-weight: 600; display: flex; align-items: center; justify-content: center; cursor: pointer; }
.add-to-cart-btn:hover { background: var(--primary-dark); }
.add-to-cart-btn:disabled { background: #a0aec0; cursor: not-allowed; }
.add-to-cart-btn.button-highlight { background: #4caf50 !important; transform: scale(1.05); }

/* ==============================
   4. МОДАЛКА
================================*/
.modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1000; display: none; } /* фон модалки */
.modal-content { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background: var(--card-bg); border-radius: 20px; padding: 24px; width: 90%; max-width: 400px; max-height: 80vh; overflow-y: auto; } /* тело модалки */

.modal-header { position: relative; text-align: center; margin-bottom: 20px; } /* заголовок */
.modal-title { font-size: 20px; font-weight: 600; } /* текст заголовка */
.close-modal { position: absolute; top: -5px; right: 0; font-size: 24px; background: none; border: none; color: var(--text-color); cursor: pointer; } /* кнопка X */

.modal-image-slider { position: relative; width: 100%; height: 200px; margin-bottom: 16px; border-radius: 16px; overflow: hidden; } /* картинки внутри модалки */
.modal-image-slider img { width: 100%; height: 100%; object-fit: cover; }
.modal-image-slider .slide { position: absolute; top: 0; left: 0; width: 100%; height: 100%; opacity: 0; transition: opacity .5s; }
.modal-image-slider .slide.active { opacity: 1; }

/* секция веса */
.weight-section { margin: 20px 0; }
.section-title { font-weight: 600; margin-bottom: 12px; text-align: center; }

/* блок итогов */
.modal-summary { margin: 20px 0; display: flex; flex-direction: column; gap: 12px; }
.summary-item { display: flex; justify-content: space-between; font-size: 14px; }
.summary-totals { display: flex; gap: 14px; flex-wrap: wrap; }

/* ==============================
   5. КОРЗИНА
================================*/
.cart-indicator { position: fixed; bottom: 20px; right: 20px; width: 56px; height: 56px; display: none; align-items: center; justify-content: center; cursor: pointer; z-index: 1000; } /* пакет внизу справа */
.cart-indicator.visible { display: flex; }

#modalCartIndicator { position: absolute; bottom: -10px; right: -10px; width: 56px; height: 56px; z-index: 3000; } /* пакет внутри модалки */
#modalCartIndicator img { width: 100%; height: 100%; object-fit: contain; } /* иконка пакета */
#modalCartIndicator .cart-count { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background: var(--primary); color: #fff; font-size: 12px; font-weight: 600; border-radius: 50%; padding: 2px 6px; } /* число на пакете */

/* ==============================
   6. УВЕДОМЛЕНИЯ
================================*/
.notification { position: fixed; top: 20px; left: 50%; transform: translateX(-50%); padding: 12px 24px; border-radius: 8px; color: #fff; opacity: 0; transition: opacity .3s; z-index: 10000; } /* всплывашки */
.notification.visible { opacity: 1; }
.notification.success { background: var(--primary); }
.notification.error { background: var(--error); }
.notification.info { background: #4a5568; }
